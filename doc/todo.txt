ROAD TO ALPHA :::
- End screen when leaving top wormhole
	- Confirmation message
	- Success ("You are rich") / failure ("You can't leave yet")
	- Final scoring
- Generate Level data :
	- 12 "Main" levels
		- 1 "Special" level with Converter of Yendor
	- 3 Branches (for now, 3 level each ? 2 filler & 1 "special")
		- Human Fortress
			- Last level should be peaceful and contains a bunch of shop.
		- Jerg Homeworld
			- Last level contain a "Queen" boss that spawns ennemies (Queen could drop some garantied artifact ?)
		- Vorg Homeworld
			- Last level contains a "Titan" "Cube" boss and lots of loot ?
	- Equipment (see excel)
		- Code Feature
		- Add item to JSON
		- Add to spawn list everywhere !
		- Add to converter
	- Ships
		- Human (Basic)
			- Art
			- Stats
			- JSON
		- Jerg (Swarm, no shield, big hull, fast)
			- Art
			- Stats
			- JSON
		- Vorg (Big shield, effect weapon (disable ship equipment, poison like effects, slow down, etc.)
			- Art
			- Stats
			- JSON
		- Random Unique boss
			- Death Star ?
				- Art
				- Stats
				- JSON


TODO :::
- Add random derelic you can pickup items from
	- when trying to pickup derelic should warn player : "not empty" (see final converter of yendor)
- recipe row size != inventory row size
- Converter recipe list has heigher rows than other lists
- managed to drop and pickup object in same frame resulting in a crash (from inventory window drop an item with a sort of double-click)
	- Also, Unhandled_input is getting called even tough I have a full screen control stopping inputs... why ? (related to drag&drop ?)
- customize scroll bar ?
- don't let planet material spawn under the player
- death screen need beautification
- add hit FX
- categories in crafting material list (when more than 4-5 items)
- add icon in material list in crafting diag
- leaderboard display improvement (scroll is not ideal yet)
- a way to id player ship when scrolling the map around
	- button to re-center ?
	- feedback when in 'goto' mode ?
	- little arrow showing the player <-- The Ombarus
- BUG: craft scout, transfer all, notice scout disapear from screen, put back scanner and scout comes back to live (ultimate scanner).
- "grab" menu when multiple objects ?
- crash trying to convert 10 missile to energy (CNR)
- warp effect when travelling in wormhole (should also be how the game launch when you hit "new game")
- Border around level is ugly
	- give it a "danger" kind a texture ?
	- remove it and warn the player : "cannot get out of sun's gravity well"
	- ???
- SOUNDS
	- Investigate how to trigger basic sounds (buttons, shooting, explosions)
		- AudioStreamPlayer (base, 2d, 3d). Works with Wav (sfx) or Ogg (music/dialog)
	- Find free sounds I could use for now
	- Investigate music style and artists that could do something nice
		- maybe should have a few different music (do something with music when health is low or ennemy is close, etc ?)
			- Star Ocean First Departure
			- Disgaea ?
			- Final IX battle theme ?
	- SFX :
		- Button hover, click
		- Moving swoosh ?
		- engine noise when zoomed in close (2d for when panning the camera)
		- Beeping for white, yellow and red log messages
		- Crafting noise for converter
		- Equip noise for mounting
		- Shooting Noise (Laser, Missile)
		- Impact noise (diff for shield and hull ?)
		- Boom for destruction
		- Noise for item drop / planet harvest drop ?
			- different noise for each category of drop ?
		- Noise for transfer from ship to ship (or same as equip ?)
		- Use nanobots
		- Wormhole warp
		- autopilot interupted ?
	- music
		- change music when aggressive ennemy hunting ?
		
- Still can get shot before autopilot stop... why ?
- Achievements
- Could not install on OnePlus 3T Oreo (test with father's phone)
- Go back and fix & add all missing shortcuts for all buttons in the UI
	- Issues in main menu (esc doesn't work ?
- Find a way to make a good UI for PC AND mobile... how to adjust font size and such ?
- Allow clicking outside of the map to move (it has weird behavior now with contextual clicks)
- BUG: Global max seem broken. More than one of the same branch wormhole sometimes spawn
- OPTIM : scanner
	- AI are only interested in player so don't check all surrounding
	- Can not check empty tile to avoid 80x80 tile check with the ultimate scanner ?
- OPTIM : loading json cache
- BUG: moving while targetting will cancel overlay but won't push back HUD

- going down wormhole should take ap and/or energy
- Don't potion if not needed !
- Perf issues on my tablet
	- Text UI take too long to render (1 draw call per char!)
	- https://github.com/godotengine/godot/issues/11797
	- https://github.com/godotengine/godot/issues/19917
- Things that annoy me while playtesting :
	- dragging converter list doesn't move the list.. very difficult on device to hit the scroll
- BUG: can't fire multiple weapon if we select a target out of range (works if we select empty tiles)
- level generation improvement :
	- have the spawn chance be able to have group of related elements (so I can spawn for example, 3 missiles next to each other 0.1% chance per level)
		- make for more story like spawns like a missile launcher and 2-3 missile and maybe a broken down prop next to each other but relative position instead of absolute like the sun
	- revisit spawn chance... could I specify it in chance per level instead of per tile ? would make tweaking level design easier (1 per level is a chance of 0,00015625 !)
	- Sokoban example : might want to spawn wormhole #1 OR #2.. not both, but definitly at least 1
	- Nethack : Quest level different by race (I don't have race for now ?)
	- Dependency ? Castle can spawn between 25-29 but never before medusa
- Message if you try to go up the home wormhole
- Save after each turn
- make sure player cannot generate more energy than max capacity
- review multi-tile objects
	- Collision on each tile but behave as a single entity ?
- BUG: Any random interaction should cancel targetting ?
- Spawning
- re-work Object identification (show as unknown, then remember id-ed stuff)
- Basic interaction
	- Look around
		- select item using keyboard
	- Shoot
		- select target using keyboard
- Two places where I access cargo content and just do -= 1. or .remove()... but if the result returned was in BaseAttribute that's dangerous

- check if assigning array or dictionary copy or reference content in godot
- Look & feel
	- Icons :
		- Converter
		- Hydrogen
		- Scanner
		- Shield
		- Laser turret
		- Missile Launcher
		- Ship parts ?

	
	
	
polish :::
- Multiple save slot for different runs ?
- Improve, beautify and add stuff to settings
	- language
	- sound volumes
	- resolution (PC only ?)
	- vsync (PC only ?)
	- key bindings (PC only ?)
- dialog cancel button doesn't fit well
- more dynamic Camera ? (shakes when hit, smooth movement, smooth zoom, etc.)
- Transfer UI should display player's ship name (crafted ship could have a 1, 2, 3, 4... appended ?)
- Make the planets spin on themselves
-- (suggestion) from Destragon on youtube : Mousing over things should automatically display the description in the text box at the bottom without requiring you to press l for look.
- welcome screen presentation is lacking (bunch of colors, line length mismatch, italic, bold, underline... need better design)
- Highlight last run in leaderboard in main menu
- Sort energy recycler need list from most energy to less energy
- Loot interface :
	- when drag & dropping.. highlight mount slot that fit with the object being draged
- Generic system to show/hide button based on player inv/equippement
- Cache JSONs when loaded 
	- so I stop getting it from disk everytime I need the attributes of an equiped object,
	- base_attributes could also be changed to point to the cached data to avoid duplication
- When dead FTL button stays invisible ?
- Drag-cancel as % of screen resolution
- smooth camera (a la township?)
	- smooth zoom limits & exponential zoom
	- drag still remember even tough camera doesn't pass limit
	
- Read-Only base_attributes to prevent un-savable changes by mistake
	
- Godot : Implement Localization
	- You can link CSVs in localization, replace certain resources (like textures) with others and even change the project name based on choosen locale
	- CSVs file are automatically converted into localization files
		- use tr() method to get translation from keyboard
		- button labels and such automatically check if text is a key and translate
		- for format godot support stuff like "bleh {id}".format({"id":"hello world"})\
		
IDEAS:::
- If you try to produce energy over the maximum of the ship capacity there is a chance you "choke" (engine goes critical and blow up)
	
	
DONE ::: 
- Bind "return" key for "ok" btn
- Tweak: Should be able to hold hulls for crafting scout in scout (at least if drop everything)
- Save node's rotation (position is saved but not rot)
- fix max cargo. make sure we're never above cargo capacity
	- check if we always update current cargo volume
- Tweak: Probe doesn't have enough cargo space to hold any hulls for crafting which means we can be stuck in a probe forever ? (you can pickup anything now... just won't be able to move)
- clean name (always return the id with or without "res:")
- Refactor equip mount dialog with similar drag&drop instead of two annoying separate popup
- transfer drag&drop dialog. Should ask for how many of a stack to transfer
- BUG: the "ok" buton can trigger multiple windows (like how many dialog 'ok' and the close converter 'ok')
- BUG: scaling UI issues on android ? 
	- (seem to be a text_width issue with font oversampling)
	- Hopefully it can should be fixed ? only happen with my mono custom font,
	- doesn't happen with godot's default font (maybe because it's not oversampling ?)
	- https://github.com/godotengine/godot/issues/22580#issue-365322210
- Look button should popup a window with details ?
	- How to handle multiple item on same tile ? (back and forth button in the dialog ?)
- should display # of turn when crafting
quit show player name popup, [n] doesn't work ?)
	- [esc] in main HUD should pop setting diag ?
- Background for bottom_title ship name in status bar
- bottom line of dialog over cancel button doesn't disapear anymore
- No Wait button for mobile (with contextual click it can be tricky to click on yourself)
- Button size and spacing is uneven
	- Windowed, resolution
- black text stay stuck when switching between mounts and cargo in inventory dialog
- BUG: Loading level doesn't load the same planet sprite ? (because it's random choice ?)
- Polish Energy "Recyling" informations in crafting UI
- Block background in the howmany dialog
- Find a way to show how many of something you already have when crafting
- Try to figure out a way the player can see attributes for any objects easily (from any dialogs or HUD) (there's a description ? button nearly everywhere now)
	- Move all cargo button shouldn't affect mounts, there should be a move all mounts button that moves only mounts that fit free spots
- block button shortcuts when dialog is open
- Change FTL button to say > or < depending on wormhole data
- Crafting interface
	- Automatically check item necessary for recipe (if possible)
	- Mark missing item in red in description
- Scan
		- Give health remaining on ships
		- Give detailed description of planet (rich but hard to mine, poor but easy to mine, etc)
- description if field is null do not display or display (N/A, No Data ?)
- destroyable.hull should be destroyable.current_hull
- BUG: still have negative inventory sometimes
- missile icon gone from recipe menu
- fog too subtil
- planet icons not set (for multiple-target dialog)
- drag & drop to mount from inventory window
- can't see red line of targetting HUD when zoomed out
- Log window text not window size
- UI is slightly off on android since update to 3.1 (probably because of native resolution vs stretch settings in project ?)
- Broke green background in converter
- Can't go fullscreen with the game options (need to trigger it manually in the code)

- Fix Shortcut in the MainMenu... I wish I could have the UIManager in MainMenu... is it possible ?
- hitting shortcut 'c' while in crafting double-pop the craft window and disable it ! (fixed by new shortcut manager)
- include energy used by idle turn in crafting total energy cost
- Transfering ship & ship item should take AP
- Review the fact that crafting takes time so producing energy takes energy = to idle amount...
- transfer window cargo capacity start at -140 ?
- ghost of planets are always the same instead of being themselves ? (because the sprite is randomized ?)
- Delete old inventory, old transfer, old mount and all btn and reference to them in code and git
- new Inventory UI doesn't display remaining cargo
- "mount where" in inventory shouldn't display if there's only one possible mount position
- Refine Need/Using list in converter UI (maybe a title + some outline for the list?)


- Contextual click : if there's an object on a planet... don't attack planet ?
- Equip jerg converter crash game (CNR)
- Title doesn't update in weapon HUD
- Drag & drop in inventory crashes game
- cancel targetting on key pressed on pc
- Put the name of the weapon in targetting overlay (also put something more clear with boarding and transfering)
- Make a late-game level and test late-game balancing (debug switch in levelloader)
- BUG: Can pickup converter of yendor battleship hull and lose converterg
- BUG: Swapping gravitic compactor didn't reset my cargo space

- Change name of FTL button
- Change status bar name with actual ship name
- Add question mark in lower-right corner as a sort of "tutorial"


- BUG: ship spawned from planetary defence wait 3-4 turns before moving

- human frigate don't play their explosion
- BUGBUGBUG: something weird happens if I try to install a cargo compressor next to solar array


- Limit leaderboard to top 100
- update player name and z_index when changing ship
- fixed crash when calculating score if no converter installed
- Scanner pickups up wormhole on first turn after going up/down when trying auto-pilot
	(was issues with scanner being updated in _process() but go-to happen in  event called by _process() from AP Behavior which is before everything else)
- Make sure player ship is on top of everything
	(also added preference, sun is below everything, ennemy ships above everything but player, etc.)


- Update Converter recipes with mk2-3, etc.
- BUG: "take all" in transfer window would duplicate items if multiple mounts of same type
- Cleaned up converter mk2 and yendor (not sure of balance)
- BUG: Can transfer cargo from ennemy ships
	- What are the conditions if not for having cargo component ?
		(Added transferable attribute to cargo)
- contextual click should have priority :
	1. attack ennemy ship, not planet and especially not boardable ship (check distance)
	2. pickup anything lying around
	3. attack planet
	4. transfer items (check distance)
	5. attack anything attackable ?
- BUG: Contextual touch only if object is visible !



- Finally removed all "inspired" sprites, sun and planets are my own invention now
- Revamped space background to be more subtle
- BUG: switching ship reset ghosts ? (mk2 scanner replaced everything with ? even ghosts I had already seen)
- Cancelling autopilot without moving still takes 1 turn (like if ennemy is too close to trigger autopilot)
- try to improve font rendering speed by replacing bbcode with regular labels (2fps gain on my tablet)
- various crashes fix (by checking for null mostly)


- Don't drop item when equipping new one, send to cargo
- Swapping scanners would sometime cause crash and/or weird bugs (especially with ultimate scanner)
- BUG: Going up a wormhole I got an NULL objById 417 when trying to update the scanner
	- (I think this was because ObjByID sets ids to null when removing ghosts but sometime in the same loop where we reference the ghost)
- Fixed ultimate_scanner breaking goto auto-stop feature
- Equip/unequip mount did not take AP



- Jerg move always in group bigger than 1
- BUG: turn number is not saved / loaded



- stop and/or prevent auto-move when energy low
- getting shot at should cancel goto
- Add stop message when doing goto ? (Ennemy ship entered scanner range, Ennemy ship too close, discovered planet, etc.)


- BUG: having more than one non-stackable item of the same type would screw up cargo
- BUG: Draging the camera while in look-around would cancel look-around
- BUG: Crashes, NULL and other crazyness still in leaderboard




- Menu button in HUD with "save and quit", "suicide" (eventually "options" too ?)
- BUG: Crashes because I insert NULL and list data in perm_save ?!?
- Quality of life : when clicking transfer all... if left ship has weapon and right ship has empty weapon... move to mount instead of cargo


- Review the fact that as you become powerful you will use more energy. Even if the weapons are more efficient, the ennemies will be harder to kill so how to you keep your energy needs in check ?
	- Homeworld planet should have higher chance of being colonized
	- Deeper planet could drop more Uranium
	- Deeper planet could have something even better than Uranium (or battleship might have bigger chance to drop unobtainium)
- Added shield mk2 & 3 (medium, large)
- Made rows a bit larger in converter for easier picking with finger
- Removed "description" in converter because it's just repeating the same informations
- Added background to modal HowMany dialog
- Increased damage profile of advanced weapons (mk2 & 3)
- Scanner mk2 reveals fully big bodies
- "unknown" marker's position are updated if object moves


- Refactor weapon system to work with multiple weapons
	- add "skip" button to weapon targetting overlay
	- add "cancel shots" button to targetting overlay
- Tweak: Probe couuld have a higher chance to drop scanner MK2 than other things in the game
- BUG: Number of visited solar system need to be saved and restored from save
- BUG: Ghost missile in inv when 0 missile
- BUG: Load and save num_generated_level for leaderboard score
- how_many dialog init to max value
- BUG: bad stackable!=true check in converter prevented converting multiple of the same type
- BUG: AI didn't use AP when missing shots
- up and down wormhole should have different sprite
- BUG: look around reveal hidden objects



- Add ability to spawn from scene template anywhere (not just level creation)
- BUG: wormhole shader doesn't do anything on my Tablet (updated godot to 3.1)
- Endgame :
	- spawn pre-generated modules (group of ennemies, specific planet with specific drop, etc.)
		- pre-generated modules might have special AI behavior :
			- group of ennemies should stick together until player is detected then go for the kill in their own way (pathfinding could be "goup" and one "group_leader" ?)
			- module bounding box... so we don't spawn stuff randomly outside bounds of the level
	- going up first wormhole check for win condition
	- improve scoring and leaderboard
- BUG: Auto-pilot can stay stuck if target is out of bounds
- highlight (like targetting overlay) the tile currently under the mouse
- BUG: when transfering between ship.... there seems to be some error in cargo volume calculation
- BUG: transfering converter of yendor to my inv makes my converter disapear


- BUG: Mouse stay stuck if moving camera when sub-menu is up
- BUG: Going down wormhole without scanner make the whole map visible ?
- BUG: changing level loads default_player instead of saved ship (multiple bugs on this one, some stupid, some less obvious)
- BUG: GOTO should not trigger (or cancel) if ship is over-weight


	- pinch zoom on device
- Implement consumable interface
	- UI
	- JSON
	- effects
- BUG: Crash if you mount nothing in mount window



- when ennemies miss the fx doesn't show (but the code is there)

- Reset Crafting lists when crafting done
- Make craft button craft more than one thing if enough items are in using list
- BUG: Touching myself in fast-travel sends me random location (ai was choosing a random destination because we were already there)
- can't craft ship with found body (scout ?) (frigging issue between "res://src" and "src")


- BUG: targetting overlay can stack when clicking weapon button multiple time (should pop HUD too maybe ?)
- BUG: weapon button missing when tranfering ship
- BUG: Transfering mounts duplicate cargo content ?!?




- BUG: Question mark pop up with ghost
- BUG: Changing mounts did not drop the item !
	- touch to goto and stop if something interesting enter sight
- New scanner :
	- Detects unknown large objects, displays them as ghost '?'
- Make energy be consumed per turn, not per move (so that we use energy even when we wait)


- prototype having more than one weapon mount (right now I assume mount points are both type and unique ids)
	- convert all mount to arrays ?
	- How to handle weapon mounts with different weapon equipped ? with different range and firing pattern ?
	- multiple shields. Should one shield empty then the other or both empty at the same rate ? what happen when one shield is bigger than another ?
	- can you stack the same utility ? (multiple solar arrays, multiple cargo compactor ?) (diminishing return ?)
	- should stacked shield also provide diminishing return ?
- Check Globals.total_turn - last_update is done after calculating stacking for all systems
- Refactor all inventory dialog to work with arrayed mounts
	- equip scene
	- jettison scene
	- transfer scene
	
	
- Welcome Screen
- transfer window need to update cargo.
- ship cannot move if over cargo



- same-tile multi-target selection dialog
- Tweak: Probe should have higher chance to drop something usefull (at least 2 hydrogen)... or it's not worth wasting a missile on them
- BUG: Crash when trying to fire when no weapon equipped
- Targetting display twice in the middle right quadrant
- BUG: Shuttle is pointing wrong way
- BUG: Missing 
		"equip_ap":3.0,
		"unequip_ap":3.0 for various obj (laser, missile_launcher... ?)
- Memory should be copied over to new ship ?
	- Ability to drop cargo if other cargo is empty
- BUG: Weird interaction when camera bump limit


- Transfering item should go through inventory system ?
- BUG: Hydrogen can spawn outside the map from planet
- Work on loot interface
	- Save changes on "ok" pressed
- Camera should not move when using dialog
- BUG: changing ship should update converter button visibility (and maybe others ? wormhole ?)
- BUG: Dropping / removing scanner should update scanner behavior
- BUG: ran out of energy with 3 000 to spare after playing for a while ? (when shields where full and you got hit, you used all energy since last time you were hit)
- BUG: I can target myself !
- Ship transfer and crafting
- BUG: Destroying crafted ship is consired player and die ? (fixed itself with other fixes ?)
- BUG: issues with AP when switching ship
- Probe hull is not consumed when making ships
- Animation !
- Make energy work
	- Assign energy for actions
	- Use energy when doing actions
	- Look around
- "more" button with a list of less common actions (look around, equip/unequip, etc.)
- Equipping objects duplicate them ! (mis-calling a signal (gotta be careful with parameters, it fail silently))
- Shields ?
	- no health regen... but implement shield that DO regen (at the cost of energy ?)
	- Use Matter-Energy converter to produce energy
		- Spawn items from destoyed ships
	- save and restore modified attributes
- Basic AI
	- Shoot back
- Mersenne Twister
- BUG: don't consume energy or AP before knowing if we have enough ammo !
- BUG: when 0 missile in inventory, still shows Missile (but not "1 x" ***) (problem with data being : "data/json/..." and src being : "res://data/json/...")
- BUG: laser still use missiles ? (forgot to remove ammo from json)
	- Add lasers (shoot in straight line (left-right-up-down), do not use ammo, use more energy per shot)
	- Limit grid to weapon range
	- Death if no hull or energy
	- energy to matter converter
		- design (crafting system ? simple change hydrogen into energy?)
		- implement new UI for crafting
	- Update hull and energy in status bar
- Start Menu
- Result screen on death
- Make converter button invisible if no converter equiped
- Equip items
- Die when 0 energy or 0 hull
- Position of player ship when going up/down wormholes (In the end I just have an enum. Hackish but couldn't figure out a better way)
	- Maybe need to pass some "origin" parameter
		- origin is null, player should be on top wormhole
		- origin is X,Y, put player at XY
- Memory / scanner issues when going up & down levels (scanner reference deleted objects ? yet it should be clearing it's list when an object is deleted... need investigating)
- Starting wormhole is invisible because of memory... why ?
- FoW (Fog of War)
	- "remembered" sprite appearance
	- Not visible sprite
	- Fog of War "look"
- Memory system :
	- Desaturation shader for sprites
	- Pass modified_attributes init param to CreateNode() method
	- add a "memory" attribute with "reference_unique_id" and "saturation_value"
	- have either MemoryBehavior or SpriteBehavior (or both together) create the sprite then set the saturation in the shader
- Load and Save
- Fixed data for wormholes



- Run on Android
- message log when passing over an object
- fix cargo hold storage volume check with base_attributes & modifed_attributes
- Drop
	- Display inventory
		- Display volume used / volume capacity
		- Dialog ok/cancel buttons
		- Decide on the way to do selection


- Pickup
- Destroy other ships
- Spawn resource from planet
		
		
- (AI)Ship move
- Random planet
- Random ships (at least 2 types)
- Data System
- Move around using touch control & keyboard
